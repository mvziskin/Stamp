<!DOCTYPE html>
<html lang="en">
<!-- ... (previous head content remains the same) ... -->
<body>
    <!-- ... (previous body content remains the same) ... -->

    <script>
        // ... (previous script content remains the same) ...

        function capturePhoto() {
            const ctx = canvasElement.getContext('2d');
            canvasElement.width = videoElement.videoWidth;
            canvasElement.height = videoElement.videoHeight;
            
            // Clear the canvas first
            ctx.clearRect(0, 0, canvasElement.width, canvasElement.height);
            
            // Draw the current video frame
            ctx.drawImage(videoElement, 0, 0);
            
            // Format the timestamp
            const now = new Date();
            const timestamp = now.toLocaleString('en-US', { 
                year: '2-digit', 
                month: 'numeric', 
                day: 'numeric', 
                hour: 'numeric', 
                minute: '2-digit', 
                second: '2-digit', 
                hour12: true,
                timeZone: 'America/New_York'
            }) + ' EST';
            
            // Add timestamp to the image
            addTextToImage(ctx, timestamp, 10, 30);
            
            // Get and add GPS information
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    const { latitude, longitude } = position.coords;
                    addTextToImage(ctx, `GPS: ${latitude.toFixed(6)}, ${longitude.toFixed(6)}`, 10, 60);
                    savePhoto(canvasElement.toDataURL('image/jpeg'));
                },
                (err) => {
                    console.error("Error getting location:", err);
                    addTextToImage(ctx, "GPS: Location not available", 10, 60);
                    savePhoto(canvasElement.toDataURL('image/jpeg'));
                },
                { enableHighAccuracy: true, timeout: 5000, maximumAge: 0 }
            );
        }

        // ... (rest of the script remains the same) ...
    </script>
</body>
</html>
